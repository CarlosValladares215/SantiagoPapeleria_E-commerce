<section class="py-10 bg-[#F2F2F2]">
  <div class="container mx-auto px-4 max-w-6xl">
    <div class="text-center mb-8">
      <h2 class="text-4xl md:text-5xl font-bold text-[#104D73] mb-6">
        ¡Productos más <span class="text-[#F2CB07]">Vendidos!</span>
      </h2>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 justify-items-center">
      <div *ngFor="let product of products"
        class="bg-white rounded-xl shadow-md hover:shadow-lg transition-all duration-300 overflow-hidden border border-gray-100 w-full max-w-xs">

        <!-- Imagen más pequeña -->
        <div class="relative">
          <img [src]="product.image" [alt]="product.name" class="w-full h-32 object-cover" />

          <!-- Etiqueta de stock baja -->
          <div *ngIf="product.isLowStock && product.stock > 0"
            class="absolute top-2 left-2 bg-[#F2CB07] text-[#012E40] px-2 py-0.5 rounded-full text-xs font-bold">
            ¡Pocas! {{ product.stock }}
          </div>

          <!-- Etiqueta agotado -->
          <div *ngIf="product.stock === 0" class="absolute inset-0 bg-black/40 flex items-center justify-center">
            <span class="bg-red-600 text-white px-3 py-1 rounded-xl text-xs font-bold">
              AGOTADO
            </span>
          </div>
        </div>

        <!-- Contenido más compacto -->
        <div class="p-3">
          <!-- Marca y nombre -->
          <div class="text-xs text-gray-500 mb-1">{{ product.brand }}</div>
          <h3 class="text-sm font-bold text-[#104D73] mb-2 line-clamp-2">
            {{ product.name }}
          </h3>

          <!-- Precios compactos -->
          <div class="mb-2">
            <div class="flex items-center justify-between mb-1">
              <span class="text-lg font-bold text-[#104D73]">
                ${{ product.price | number:'1.2-2' }}
              </span>
            </div>

            <!-- Precio mayorista reducido -->
            <div *ngIf="!authService.isMayorista()" class="bg-[#F2DF7E] p-1 rounded-lg">
              <div class="flex items-center justify-between">
                <span class="text-xs text-[#012E40] font-semibold">
                  Mayorista: ${{ product.wholesalePrice.toFixed(2) }}
                </span>
                <a *ngIf="!authService.user()" routerLink="/login" class="text-[10px] text-[#104D73] hover:underline">
                  Iniciar Sesión
                </a>
              </div>
            </div>
          </div>

          <!-- Estado de stock compacto -->
          <div class="mb-3">
            <span *ngIf="product.stock > 5" class="text-green-600 text-xs font-medium">
              ✓ En Stock
            </span>
            <span *ngIf="product.stock > 0 && product.stock <= 5" class="text-[#F2CB07] text-xs font-medium">
              ⚠ Solo {{ product.stock }}
            </span>
            <span *ngIf="product.stock === 0" class="text-red-600 text-xs font-medium">
              ✗ Agotado
            </span>
          </div>

          <!-- Botones compactos -->
          <div class="flex gap-1">
            <a [routerLink]="['/product', product.id]" class="flex-1">
              <button class="w-full border border-[#104D73] text-[#104D73] px-2 py-1 rounded-lg text-xs hover:bg-[#104D73] hover:text-white transition">
                Ver
              </button>
            </a>
            <button class="flex-1 px-2 py-1 rounded-lg text-xs"
              [ngClass]="product.stock === 0 ? 'border border-gray-400 text-gray-400 cursor-not-allowed' : 'bg-[#104D73] text-white hover:bg-[#0d3d5a]'"
              [disabled]="product.stock === 0">
              {{ product.stock === 0 ? 'Agotado' : 'Agregar' }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Botón más pequeño -->
    <div class="text-center mt-8">
      <a routerLink="/products">
        <button class="bg-[#F2CB07] text-[#012E40] px-6 py-2 rounded-lg font-semibold text-sm hover:bg-[#F2DF7E] transition">
          VER TODOS LOS PRODUCTOS
        </button>
      </a>
    </div>
  </div>
</section>