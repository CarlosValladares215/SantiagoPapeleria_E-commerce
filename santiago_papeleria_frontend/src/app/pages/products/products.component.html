<div class="min-h-screen bg-[#F2F2F2]">
    <!-- Notification Toast -->
    <app-toast-container></app-toast-container>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-10 pb-10">
        <!-- Breadcrumb -->
        <!-- Breadcrumb -->
        <nav class="flex items-center gap-2 mb-6 text-xs text-[#104D73]/80">
            <a routerLink="/" class="hover:text-[#F2CB07] transition-colors">Inicio</a>
            <span class="material-symbols-outlined text-[10px]">chevron_right</span>
            <span class="text-[#104D73] font-bold">Productos</span>
        </nav>

        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Sidebar Filters -->
            <app-products-filter-sidebar [filters]="filters()" [showFilters]="showFilters()" [categories]="categories()"
                (filterChange)="handleFilterChange($event.key, $event.value)" (clearFilters)="clearFilters()">
            </app-products-filter-sidebar>

            <!-- Main Content -->
            <div class="flex-1">
                <!-- Header Controls -->
                <app-products-header [productCount]="productService.paginationMeta().total"
                    [currentSort]="filters().sortBy" [showMobileFilters]="showFilters()"
                    (sortChange)="handleFilterChange('sortBy', $event)" (toggleFilters)="toggleFilters()">
                </app-products-header>

                <!-- Products Grid & Loading State -->
                @if (productService.isLoading()) {
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                    @for (item of [1,2,3,4,5,6]; track item) {
                    <div
                        class="bg-white rounded-2xl shadow-sm border border-gray-100 flex flex-row md:flex-col animate-pulse overflow-hidden">
                        <!-- Image Skeleton -->
                        <div class="w-32 h-36 md:w-full md:aspect-square bg-gray-200 flex-shrink-0"></div>

                        <!-- Content Skeleton -->
                        <div class="flex-grow p-3 md:p-5 flex flex-col justify-center space-y-3">
                            <div class="h-3 bg-gray-200 rounded w-1/4 mb-1"></div>
                            <div class="h-4 bg-gray-200 rounded w-3/4"></div>
                            <div class="h-4 bg-gray-200 rounded w-1/2"></div>
                            <div class="flex justify-between items-center pt-2 md:pt-4">
                                <div class="h-6 bg-gray-200 rounded w-24"></div>
                                <div class="h-10 bg-gray-200 rounded-xl w-24 hidden md:block"></div>
                                <div class="h-8 bg-gray-200 rounded-lg w-20 md:hidden"></div>
                            </div>
                        </div>
                    </div>
                    }
                </div>
                }

                @if (!productService.isLoading()) {
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8" data-product-shop>
                    @for (product of currentProducts(); track $index) {
                    <app-product-card [product]="product" (viewDetails)="navigateToProduct($event)"
                        (addToCart)="handleAddToCart($event)">
                    </app-product-card>
                    }
                </div>

                <!-- Empty State -->
                @if (productService.products().length === 0) {
                <div class="text-center py-12">
                    <i class="ri-search-line text-4xl text-gray-400 mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-700 mb-2">No se encontraron productos</h3>
                    <p class="text-gray-500 mb-6">Intenta ajustar tus filtros o b√∫squeda</p>
                    <button (click)="clearFilters()"
                        class="px-6 py-2 bg-[#104D73] text-white rounded-lg hover:bg-[#012E40] transition-colors">
                        Limpiar Filtros
                    </button>
                </div>
                }
                }

                <!-- Pagination -->
                @if (!productService.isLoading() && productService.products().length > 0) {
                <app-products-pagination [currentPage]="currentPage()" [totalPages]="totalPages()"
                    (pageChange)="onPageChange($event)">
                </app-products-pagination>
                }
            </div>
        </div>
    </main>
</div>